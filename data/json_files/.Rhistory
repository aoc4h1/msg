scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label = scales::percent(pct)), position = position_stack(reverse = TRUE, vjust = 0.5), size=c(rep(3,6),rep(0,6))) +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank())
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse = TRUE), colour="white") +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label = scales::percent(pct)), position = position_stack(reverse = TRUE, vjust = 0.5), size=c(rep(4,6),rep(0,6))) +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank())
knit2html("messages_output_v02.Rmd")
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white") +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank())
knit2html("messages_output_v02.Rmd")
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white") +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank())
knit2html("messages_output_v02.Rmd")
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", width=1) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank())
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", width=10) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank())
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white") +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank())
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank())
knit2html("messages_output_v02.Rmd")
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=2) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank())
knit2html("messages_output_v02.Rmd")
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.5) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank())
knit2html("messages_output_v02.Rmd")
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank())
knit2html("messages_output_v02.Rmd")
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = "2020", linetype="dotted", size = 0.7) +
annotate("text", x = "2020", y = Inf, label = "COVID ", angle=90, vjust=2, hjust=1)
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = "2019", linetype="dotted", size = 0.7) +
annotate("text", x = "2020", y = Inf, label = "COVID ", angle=90, vjust=2, hjust=1)
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = 2019+5, linetype="dotted", size = 0.7) +
annotate("text", x = "2020", y = Inf, label = "COVID ", angle=90, vjust=2, hjust=1)
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = 2019+0.5, linetype="dotted", size = 0.7) +
annotate("text", x = "2020", y = Inf, label = "COVID ", angle=90, vjust=2, hjust=1)
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = 2019, linetype="dotted", size = 0.7) +
annotate("text", x = "2020", y = Inf, label = "COVID ", angle=90, vjust=2, hjust=1)
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = which(d2$year > 2019), linetype="dotted", size = 0.7) +
annotate("text", x = "2020", y = Inf, label = "COVID ", angle=90, vjust=2, hjust=1)
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = c(1.5,2.5,3.5,4.5), linetype="dotted", size = 0.7) +
annotate("text", x = "2020", y = Inf, label = "COVID ", angle=90, vjust=2, hjust=1)
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = c(4.5), linetype="dotted", size = 0.7) +
annotate("text", x = "2020", y = Inf, label = "COVID ", angle=90, vjust=2, hjust=1)
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = c(4.5), linetype="dotted", size = 0.7) +
annotate("text", x = c(4.5), y = Inf, label = "COVID ", angle=90, vjust=2, hjust=1)
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = c(4.5), linetype="dotted", size = 0.7) +
annotate("text", x = c(4.5), y = Inf, label = "COVID ", vjust=2, hjust=1)
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = c(4.5), linetype="dotted", size = 0.7) +
annotate("text", x = c(4.5), y = Inf, label = "COVID ", vjust=2, hjust=-1)
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = c(4.5), linetype="dotted", size = 0.7) +
annotate("text", x = c(4.5), y = Inf, label = "COVID ", vjust=2)
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = c(4.5), linetype="dotted", size = 0.7) +
annotate("text", x = c(4.5), y = Inf, label = "COVID ", vjust=2, hjust=-0.5)
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = c(4.5), linetype="dotted", size = 0.7) +
annotate("text", x = c(4.5), y = Inf, label = "COVID ", vjust=2, hjust=-0.2)
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = c(4.5), linetype="dotted", size = 0.7) +
annotate("text", x = c(4.5), y = Inf, label = "COVID ", vjust=-2, hjust=-0.2)
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = c(4.5), linetype="dotted", size = 0.7) +
annotate("text", x = c(4.5), y = Inf, label = "COVID ", vjust=-0.2, hjust=-0.2)
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = c(4.5), linetype="dotted", size = 0.7) +
annotate("text", x = c(4.5), y = Inf, label = "COVID ", vjust=2, hjust=-0.2)
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = c(4.5), linetype="dotted", size = 0.7) +
annotate("text", x = c(4.5), y = Inf, label = "COVID ", vjust=2.5, hjust=-0.2)
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = c(4.5), linetype="dotted", size = 0.7) +
annotate("text", x = c(4.5), y = Inf, label = "COVID ", vjust=1.7, hjust=-0.2)
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = c(4.5), linetype="dotted", size = 0.7) +
annotate("text", x = c(4.5), y = Inf, label = "COVID ", vjust=1.2, hjust=-0.2)
ggplot(d2, aes(x = year, y = pct, fill = komm)) +
geom_col(position = position_stack(reverse=TRUE), colour="white", size=1.3) +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values=c("#46ABDE","#C7F9EE"),name="") +
geom_text(aes(label=scales::percent(pct)), position=position_stack(reverse=TRUE, vjust=0.5), size=c(rep(4.5,6),rep(0,6)), col="white") +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = c(4.5), linetype="dotted", size = 0.7) +
annotate("text", x = c(4.5), y = Inf, label = "COVID ", vjust=1, hjust=-0.2)
knit2html("messages_output_v02.Rmd")
### Szerinted pötyögtünk az év minden napján?
*2016-2021 teljes évek alapján [2016 szökőév]*
knit2html("messages_output_v02.Rmd")
library(lubridate)
library(jsonlite)
library(plyr)
library(doParallel)
library(foreach)
library(stringi)
library(text2vec)
library(dplyr)
library(tidytext)
library(ggplot2)
# --------- DATA
setwd("/Users/palmamogyorosi/Documents/Palma/Kreatív/2022 Barbi Messenger/data/json_files")
files <- list.files()
coln <- c("sender_name","timestamp_ms","content","type","is_unsent","photos","reactions","call_duration","videos","sticker","gifs","files")
for(i in 1:length(files)) {
if (i==1) {
data <- fromJSON(files[i])
data <- data$messages
coln.kiszed <- coln[which(coln %in% colnames(data))]
data <- select(data, coln.kiszed)
data$sticker <- data$sticker$uri
} else {
x <- fromJSON(files[i])
x <- x$messages
coln.kiszed <- coln[which(coln %in% colnames(x))]
print(coln[which(!(coln %in% colnames(x)))])
x <- select(x, all_of(coln.kiszed))
x$sticker <- x$sticker$uri
data <- rbind.fill(data,x)
rm(x)
print(paste(files[i]," join complete"))
}
}
rm(coln,coln.kiszed,i,files)
data.safe <- data
data$sender_name <- iconv(data$sender_name,"UTF-8","latin1")
Encoding(data$sender_name) <- "UTF-8"
data$content2 <- iconv(data$content,"UTF-8","latin1")
Encoding(data$content2) <- "UTF-8"
# Átalakítjuk ASCII-ra a formátumot
x <- data$content2
x <- iconv(x, from = "latin1", to = "ascii", sub = "byte")
data$text <- x
emDict <- emDict[order(nchar(emDict$r.encoding), decreasing = T),]
load("/Users/palmamogyorosi/Downloads/istat_prep_files.Rdata")
emDict <- emDict[order(nchar(emDict$r.encoding), decreasing = T),]
emDict$description <- paste("",emDict$description,"")
core.number=2
cl <- makeCluster(core.number, setup_timeout = 0.5)
registerDoParallel(cl)
split.num <- round(nrow(data) / 200, 0)
parsplit2 <- rep(1:split.num, round(nrow(data) / split.num, 0) + 1)[seq_len(nrow(data))]
parsplit2 <- parsplit2[order(parsplit2, decreasing = FALSE)]
do.emoji.change <- function(i) {
con <- x[which(parsplit2 == i)]
x[which(parsplit2 == i)] <- stri_replace_all_fixed(x[which(parsplit2 == i)], pattern = emDict$r.encoding, replacement = emDict$description, vectorize_all = FALSE)
res1 <- x[which(parsplit2 == i)]
assign("res1", res1, envir = .GlobalEnv)}
z <- foreach::foreach(i = 1:split.num, .packages = c("stringi", "text2vec"), .combine = c, .export = "x") %dopar%
do.emoji.change(i)
x <- z
rm(z)
data$text <-  stri_replace_all_fixed(x, pattern = ekezet.ascii$kod, replacement = ekezet.ascii$ekezet, vectorize_all = FALSE)
rm(x,cl,core.number,parsplit2,split.num,do.emoji.change)
rm(emDict,dbpedia.ki,ekezet.ascii,ellentet,nevek)
View(data)
# reorder columns
data <- select(data, sender_name:content,content2,text,type:files)
# lowercase
data$text <- tolower(data$text)
data$year <- substr(data$timestamp_ms,1,4)
data$month <- substr(data$timestamp_ms,1,7)
data$day <- substr(data$timestamp_ms,1,10)
save.image("~/Documents/Palma/Kreatív/2022 Barbi Messenger/data/messages_data.RData")
library(dplyr)
library(knitr)
library(ggplot2)
library(tidyr)
knitr::opts_knit$set(progress = FALSE, verbose = FALSE)
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)
knit2html("messages_output_v02.Rmd")
knit2html("messages_output_v02.Rmd")
library(dplyr)
library(knitr)
library(ggplot2)
library(tidyr)
knitr::opts_knit$set(progress = FALSE, verbose = FALSE)
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE)
d1 <- data %>%
group_by(year,day) %>%
count()
ggplot(d1, aes(x=as.factor(day), y=n, fill=as.factor(year))) +
geom_col() +
scale_fill_brewer(palette = "Spectral",name="") +
scale_x_discrete(breaks=c("2016-01-01","2017-01-01","2018-01-01","2019-01-02","2020-01-02","2021-04-01","2022-04-01")) +
theme_minimal() +
theme(legend.position="bottom",legend.text = element_text(size=11, colour="#404040",margin = margin(r = 30)),
axis.text = element_text(size=10), axis.text.y = element_text(margin = margin(r = 10)),
axis.text.x = element_text(margin = margin(t = -5)),
axis.title = element_blank(), plot.background = element_blank(),
panel.grid.minor = element_blank(), panel.grid.major = element_blank()) +
geom_vline(xintercept = "2016-10-01", linetype="dotted", size = 0.7) +
annotate("text", x = "2016-10-01", y = Inf, label = "Első csók ", angle=90, vjust=2, hjust=1) +
geom_vline(xintercept = "2018-08-01", linetype="dotted", size = 0.7) +
annotate("text", x = "2018-08-01", y = Inf, label = "Összeköltözés ", angle=90, vjust=2, hjust=1) +
geom_vline(xintercept = "2020-03-11", linetype="dotted", size = 0.7) +
annotate("text", x = "2020-03-11", y = Inf, label = "COVID ", angle=90, vjust=2, hjust=1) +
annotate("text", x = "2017-03-19", y = 1000, label = "Szülinapi buli másnapja \n (nem voltál ott!)", hjust=-0.1, size=3) +
annotate("text", x = "2015-10-25", y = 380, label = "Barbi \nDánia", hjust=0.2, size=3) +
annotate("text", x = "2021-06-27", y = 232, label = "Késik a\nLatorca IC", vjust=-0.7, size=3)
